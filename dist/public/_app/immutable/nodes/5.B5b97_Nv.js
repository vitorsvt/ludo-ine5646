import{f as j,a as x}from"../chunks/VIQ-nLd-.js";import{o as X}from"../chunks/iauQH351.js";import{ac as Y,c as B,ai as Z,V as ee,L as ae,aj as te,ak as se,af as re,a1 as ne,al as b,am as C,a3 as u,l as t,a2 as le,an as d,a4 as c,a5 as l,a0 as oe,ah as F}from"../chunks/CEefkVJu.js";import{s as J}from"../chunks/DQ58N-tK.js";import{e as M,i as N}from"../chunks/Be8ClsNr.js";import{b as T,r as D,s as ie}from"../chunks/D965Rs-M.js";import{d as ue,e as ce}from"../chunks/BwqhGqo2.js";import{g as pe}from"../chunks/mqL6fNKN.js";function Q(e,o,f=!1){if(e.multiple){if(o==null)return;if(!ae(o))return te();for(var n of e.options)n.selected=o.includes(g(n));return}for(n of e.options){var v=g(n);if(se(v,o)){n.selected=!0;return}}(!f||o!==void 0)&&(e.selectedIndex=-1)}function ve(e){var o=new MutationObserver(()=>{Q(e,e.__value)});o.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ee(()=>{o.disconnect()})}function I(e,o,f=o){var n=new WeakSet,v=!0;Y(e,"change",i=>{var _=i?"[selected]":":checked",p;if(e.multiple)p=[].map.call(e.querySelectorAll(_),g);else{var y=e.querySelector(_)??e.querySelector("option:not([disabled])");p=y&&g(y)}f(p),B!==null&&n.add(B)}),Z(()=>{var i=o();if(e===document.activeElement){var _=re??B;if(n.has(_))return}if(Q(e,i,v),v&&i===void 0){var p=e.querySelector(":checked");p!==null&&(i=g(p),f(i))}e.__value=i,v=!1}),ve(e)}function g(e){return"__value"in e?e.__value:e.value}var de=j("<option> </option>"),fe=j("<option> </option>"),_e=j("<option> </option>"),me=j('<main class="svelte-hdsh4k"><form class="svelte-hdsh4k"><h1>Cadastro</h1> <label class="svelte-hdsh4k">Nome de usuário: <input name="username" type="text" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">País: <select></select></label> <label class="svelte-hdsh4k">Estado: <select></select></label> <label class="svelte-hdsh4k">Cidade: <select></select></label> <label class="svelte-hdsh4k">Avatar: <input name="avatar" type="file" accept=".jpg, .png, image/gif, .webp" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">Senha: <input name="password" type="password" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">Repetir senha: <input name="repeatedPassword" type="password" class="svelte-hdsh4k"/></label> <button type="submit" class="svelte-hdsh4k">Cadastrar</button> <a href="/login">Já tem uma conta? Entre!</a></form></main>');function Ce(e,o){ne(o,!0);let f=b(C([])),n=b("BR"),v=b(C([])),i=b("SC"),_=b(C([])),p=b("Florianópolis");async function y(){d(f,[],!0);const a=await fetch("/api/countries");d(f,await a.json(),!0)}async function V(){d(v,[],!0);const r=await(await fetch(`/api/states?country=${t(n)}`)).json();d(v,r.map(s=>({code:s.iso2,name:s.name})),!0)}async function W(){d(_,[],!0);const a=await fetch(`/api/cities?country=${t(n)}&state=${t(i)}`);d(_,await a.json(),!0)}X(async()=>{await y(),await V(),await W()});let h=C({username:"",password:"",repeatedPassword:""});async function U(a){a.preventDefault(),(await fetch("/api/register",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({country:t(n),state:t(i),city:t(p),...h})})).ok&&pe("/login")}var P=me(),q=c(P),$=u(c(q),2),z=u(c($));D(z),l($);var A=u($,2),k=u(c(A));k.__change=V,M(k,21,()=>t(f),N,(a,r)=>{var s=de(),w=c(s);l(s);var m={};F(()=>{ie(s,t(r).iso2==="BR"),J(w,`${t(r).emoji??""} ${t(r).name??""}`),m!==(m=t(r).iso2)&&(s.value=(s.__value=t(r).iso2)??"")}),x(a,s)}),l(k),l(A);var E=u(A,2),S=u(c(E));S.__change=W,M(S,21,()=>t(v),N,(a,r)=>{var s=fe(),w=c(s,!0);l(s);var m={};F(()=>{J(w,t(r).name),m!==(m=t(r).code)&&(s.value=(s.__value=t(r).code)??"")}),x(a,s)}),l(S),l(E);var L=u(E,2),O=u(c(L));M(O,21,()=>t(_),N,(a,r)=>{var s=_e(),w=c(s,!0);l(s);var m={};F(()=>{J(w,t(r).name),m!==(m=t(r).name)&&(s.value=(s.__value=t(r).name)??"")}),x(a,s)}),l(O),l(L);var R=u(L,4),G=u(c(R));D(G),l(R);var H=u(R,2),K=u(c(H));D(K),l(H),oe(4),l(q),l(P),ce("submit",q,U),T(z,()=>h.username,a=>h.username=a),I(k,()=>t(n),a=>d(n,a)),I(S,()=>t(i),a=>d(i,a)),I(O,()=>t(p),a=>d(p,a)),T(G,()=>h.password,a=>h.password=a),T(K,()=>h.repeatedPassword,a=>h.repeatedPassword=a),x(e,P),le()}ue(["change"]);export{Ce as component};
