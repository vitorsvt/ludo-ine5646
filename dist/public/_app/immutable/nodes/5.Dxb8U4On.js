import{f as j,a as x}from"../chunks/VIQ-nLd-.js";import{o as U}from"../chunks/iauQH351.js";import{ac as X,c as B,ai as Y,V as Z,L as ee,aj as ae,ak as te,af as se,a1 as re,al as b,am as C,a3 as u,l as a,a2 as le,an as f,a4 as v,a5 as o,a0 as ne,ah as F}from"../chunks/CEefkVJu.js";import{s as J}from"../chunks/DQ58N-tK.js";import{e as M,i as N}from"../chunks/Be8ClsNr.js";import{b as T,r as D,s as oe}from"../chunks/D965Rs-M.js";import{d as ie,e as ue}from"../chunks/BwqhGqo2.js";import{g as ve}from"../chunks/C_8uDaM3.js";function K(e,l,m=!1){if(e.multiple){if(l==null)return;if(!ee(l))return ae();for(var n of e.options)n.selected=l.includes(k(n));return}for(n of e.options){var d=k(n);if(te(d,l)){n.selected=!0;return}}(!m||l!==void 0)&&(e.selectedIndex=-1)}function ce(e){var l=new MutationObserver(()=>{K(e,e.__value)});l.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Z(()=>{l.disconnect()})}function I(e,l,m=l){var n=new WeakSet,d=!0;X(e,"change",i=>{var p=i?"[selected]":":checked",c;if(e.multiple)c=[].map.call(e.querySelectorAll(p),k);else{var w=e.querySelector(p)??e.querySelector("option:not([disabled])");c=w&&k(w)}m(c),B!==null&&n.add(B)}),Y(()=>{var i=l();if(e===document.activeElement){var p=se??B;if(n.has(p))return}if(K(e,i,d),d&&i===void 0){var c=e.querySelector(":checked");c!==null&&(i=k(c),m(i))}e.__value=i,d=!1}),ce(e)}function k(e){return"__value"in e?e.__value:e.value}var de=j("<option> </option>"),pe=j("<option> </option>"),_e=j("<option> </option>"),fe=j('<main class="svelte-hdsh4k"><form class="svelte-hdsh4k"><h1>Cadastro</h1> <label class="svelte-hdsh4k">Nome de usuário: <input name="username" type="text" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">País: <select></select></label> <label class="svelte-hdsh4k">Estado: <select></select></label> <label class="svelte-hdsh4k">Cidade: <select></select></label> <label class="svelte-hdsh4k">Avatar: <input name="avatar" type="file" accept=".jpg, .png, image/gif, .webp" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">Senha: <input name="password" type="password" class="svelte-hdsh4k"/></label> <label class="svelte-hdsh4k">Repetir senha: <input name="repeatedPassword" type="password" class="svelte-hdsh4k"/></label> <button type="submit" class="svelte-hdsh4k">Cadastrar</button> <a href="/login">Já tem uma conta? Entre!</a></form></main>');function xe(e,l){re(l,!0);let m=b(C([])),n=b("BR"),d=b(C([])),i=b("SC"),p=b(C([])),c=b("Florianópolis");async function w(){f(d,[],!0);const r=await(await fetch(`/api/states?country=${a(n)}`)).json();f(d,r.map(s=>({code:s.iso2,name:s.name})),!0)}async function V(){f(p,[],!0);const t=await fetch(`/api/cities?country=${a(n)}&state=${a(i)}`);f(p,await t.json(),!0)}U(async()=>{f(m,l.data.countries,!0),await w(),await V()});let h=C({username:"",password:"",repeatedPassword:""});async function Q(t){t.preventDefault(),(await fetch("/api/register",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({country:a(n),state:a(i),city:a(c),...h})})).ok&&ve("/login")}var P=fe(),q=v(P),A=u(v(q),2),W=u(v(A));D(W),o(A);var E=u(A,2),y=u(v(E));y.__change=w,M(y,21,()=>a(m),N,(t,r)=>{var s=de(),g=v(s);o(s);var _={};F(()=>{oe(s,a(r).iso2==="BR"),J(g,`${a(r).emoji??""} ${a(r).name??""}`),_!==(_=a(r).iso2)&&(s.value=(s.__value=a(r).iso2)??"")}),x(t,s)}),o(y),o(E);var L=u(E,2),S=u(v(L));S.__change=V,M(S,21,()=>a(d),N,(t,r)=>{var s=pe(),g=v(s,!0);o(s);var _={};F(()=>{J(g,a(r).name),_!==(_=a(r).code)&&(s.value=(s.__value=a(r).code)??"")}),x(t,s)}),o(S),o(L);var O=u(L,2),R=u(v(O));M(R,21,()=>a(p),N,(t,r)=>{var s=_e(),g=v(s,!0);o(s);var _={};F(()=>{J(g,a(r).name),_!==(_=a(r).name)&&(s.value=(s.__value=a(r).name)??"")}),x(t,s)}),o(R),o(O);var $=u(O,4),z=u(v($));D(z),o($);var G=u($,2),H=u(v(G));D(H),o(G),ne(4),o(q),o(P),ue("submit",q,Q),T(W,()=>h.username,t=>h.username=t),I(y,()=>a(n),t=>f(n,t)),I(S,()=>a(i),t=>f(i,t)),I(R,()=>a(c),t=>f(c,t)),T(z,()=>h.password,t=>h.password=t),T(H,()=>h.repeatedPassword,t=>h.repeatedPassword=t),x(e,P),le()}ie(["change"]);export{xe as component};
